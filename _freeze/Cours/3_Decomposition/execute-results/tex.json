{
  "hash": "a21cafbe7e837920184486e064cd9f63",
  "result": {
    "markdown": "---\ntitle: \"3 - Décomposition d'une série temporelle\"\n---\n\n\n\n\n### Objectifs de cette séquence\n\nPrésenter les principales méthodes de décomposition\n\n### Questions de positionnement\n\nPourquoi désaisonnaliser une série ?\n\nQuelles sont les principales méthodes décomposition ?\n\nQuelles sont les différents schémas de décomposition ?\n\n# Schéma de décomposition\n\n### Rappels sur les différentes composantes\n\n- Tendance-cycle : évolution de moyen/long terme de la série ($TC_t$)  \n{{< fa arrow-circle-right >}} tendance et cycle estimés conjointement : évite problèmes de définition (limite entre cycles courts et longs ?) et difficultés sur séries courtes\n\n- Saisonnalité et autres effets de calendrier (jours ouvrables, fêtes mobiles, etc.) $S_t$\n\n- Irrégulier : composante d'erreur (idéalement faible) $I_t$\n\n. . .\n\nObjectif de la désaisonnalisation : enlever $S_t$ pour mieux analyser le signal conjoncturel et faire des comparaisons temporelles/spatiales\n\n. . .\n\n$Y_t = f(S_t,TC_t,I_t)$ : quelle relation entre les différentes composantes ?\n\n### Les différents schémas de décomposition\n\n- Schéma additif :\n$$X_t = {TC}_t + S_t + I_t$$\nSchéma multiplicatif (amplitudes de $S_t$ et $I_t$ varient en fonction de la tendance) :\n$$\nX_t = {TC}_t \\times S_t \\times I_t\n$$\n\n- Schéma pseudo-additif (permet de traiter des cas où $X_t$ proche de 0) :\n$$\nX_t = {TC}_t \\times (S_t + I_t - 1)\n$$\n{{< fa arrow-circle-right >}} lorsque certains mois ont des valeurs très faibles, suppose saisonnalité et irrégulier indépendants\n\n- Schéma log-additif :\n$$\n\\log(X_t) = \\log({TC}_t) + \\log(S_t) + \\log(I_t)\n$$\n\n\n# STL\n\n### Seasonal and Trend decomposition using Loess (STL)\n\nApplication successive de Loess (régression locale robuste) et de moyennes mobiles\n\nAvantages :\n\n- Applicable sur toutes les fréquences\n\n- Robuste aux points atypiques\n\nInconvénients :\n\n- Pas de choix automatique du schéma de décomposition\n\n- Pas de correction de jours ouvrables\n\n- Pas de choix automatique des paramètres (longueur des filtres à spécifier)\n\n### Exemple (1)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(nottem)\n```\n\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-1-1.pdf)\n:::\n:::\n\n\n### Exemple (2)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(stl(nottem, s.window = 7))\n```\n\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-2-1.pdf)\n:::\n:::\n\n\n### Exemple (3) : `autoplot`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(forecast)\nstl(nottem, s.window = 7) %>% autoplot()\n```\n\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-3-1.pdf)\n:::\n:::\n\n\n\n# X-13-ARIMA et TRAMO-SEATS\n\n### Méthodes utilisées dans les INS\n\nDans les INS, les méthodes principalement utilisées sont X-13-ARIMA et TRAMO-SEATS :\n\n- Méthodes recommandées par Eurostat\n\n- Permettent de faire des CJO et de prendre en compte les spécificités calendaires\n\n- Choix automatique du schéma de décomposition (additive ou multiplicatif)\n\n- Prise en compte de différents types de ruptures\n\n- Applicables que sur des séries au plus mensuelles (travaux en cours pour étendre ces méthodes)\n\n\n### Désaisonnalisation en deux modèles\n\n1. Linéarisation de la série : correction des points aberrants, des ruptures et des effets calendriers par un modèle RegARIMA\n\n2. Décomposition de la série linéarisée : par une méthode non-paramétrique (X-11, application successive de moyennes mobiles) ou paramétrique (SEATS)\n\n### Les principaux types d'outliers\n\n\\smallskip\n\n\\begin{columns}\n\\begin{column}{0.6\\textwidth}\n\\textbf{Choc ponctuel}\n\n\\emph{Additive outlier} (AO)\n\nAffecte l'Irrégulier\n\\end{column}\n\\begin{column}{0.3\\textwidth}\n\\input{img/AO.tex}\n\\end{column}\n\\end{columns}\n\n\\begin{columns}\n\\begin{column}{0.6\\textwidth}\n\\textbf{Changement de niveau}\n\n\\emph{Level Shift} (LS)\n\nAffecte la Tendance\n\\end{column}\n\\begin{column}{0.3\\textwidth}\n\\input{img/LS.tex}\n\\end{column}\n\\end{columns}\n\n\\begin{columns}\n\\begin{column}{0.6\\textwidth}\n\\textbf{Changement de niveau transitoire}\n\n\\emph{Transitory Change} (TC) \n\nAffecte l'Irrégulier\n\\end{column}\n\\begin{column}{0.3\\textwidth}\n\\input{img/TC.tex}\n\\end{column}\n\\end{columns}\n\n\\begin{columns}\n\\begin{column}{0.6\\textwidth}\n\\textbf{Rupture de profil saisonnier}\n\n\\emph{Seasonal Outlier} (SO) \n\nAffecte la Composante Saisonnière\n\\end{column}\n\\begin{column}{0.3\\textwidth}\n\\input{img/SO.tex}\n\\end{column}\n\\end{columns}\n\n### Package à utiliser\n\nPour X-13ARIMA deux packages peuvent être utilisés :\n\n- `seasonal` basé sur les programmes du Census Bureau\n\n- `RJDemetra` basé sur les JDemetra+ (logiciel recommandé par Eurostat)\n\nTRAMO-SEATS : uniquement implémenté dans `RJDemetra`\n\n### Comparaison des performances (1)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-4-1.pdf)\n:::\n:::\n\n\n### Comparaison des performances (2)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-5-1.pdf)\n:::\n:::\n\n\n\n### Spécifications de base\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](img/seq3_specification.png){width=100%}\n:::\n:::\n\n\nParamètre `spec` dans `RJDemetra::x13()` et `RJDemetra::tramoseats()`\n\n### Exemple\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(RJDemetra);library(ggdemetra);autoplot(x13(nottem))\n```\n\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-7-1.pdf)\n:::\n:::\n\n\n### Exemple {.allowframebreaks}\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nautoplot(ipi_c_eu[,\"IT\"])\n```\n\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-8-1.pdf)\n:::\n\n```{.r .cell-code}\nmod = x13(ipi_c_eu[,\"IT\"])\n# Pre-ajustement : donne des informations sur le schéma de décomposition\n# (log ou non), sur la CJO, les points atypiques et le modèle ARIMA\nmod$regarima\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ny = regression model + arima (3, 1, 0, 0, 1, 1)\nLog-transformation: no\nCoefficients:\n          Estimate Std. Error\nPhi(1)     0.57871      0.055\nPhi(2)     0.41329      0.059\nPhi(3)     0.09131      0.055\nBTheta(1) -0.45726      0.048\n\n             Estimate Std. Error\nMonday         0.8197      0.287\nTuesday        0.8457      0.286\nWednesday      1.5247      0.286\nThursday       0.6638      0.285\nFriday         1.2974      0.288\nSaturday      -2.6035      0.285\nLeap year      3.3513      0.890\nEaster [1]    -3.0191      0.565\nLS (12-2008) -16.4492      2.149\nLS (8-2009)    9.5156      2.154\n\n\nResidual standard error: 3.023 on 332 degrees of freedom\nLog likelihood = -877.9, aic =  1786 aicc =  1787, bic(corrected for length) = 2.448\n```\n:::\n\n```{.r .cell-code}\n# Informations sur la décomposition (non traitée dans ce cours)\nmod$decomposition\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nMonitoring and Quality Assessment Statistics:\n      M stats\nM(1)    0.039\nM(2)    0.031\nM(3)    1.018\nM(4)    0.324\nM(5)    0.852\nM(6)    0.142\nM(7)    0.095\nM(8)    0.160\nM(9)    0.072\nM(10)   0.114\nM(11)   0.101\nQ       0.285\nQ-M2    0.316\n\nFinal filters: \nSeasonal filter:  3x5\nTrend filter:  13 terms Henderson moving average\n```\n:::\n\n```{.r .cell-code}\n# Séries finales estimées :\nmod$final\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLast observed values\n             y       sa        t            s           i\nJan 2019 103.1 106.8108 106.5337  -3.71079247  0.27706044\nFeb 2019 107.5 107.5520 106.4284  -0.05202971  1.12366733\nMar 2019 114.9 105.6270 106.2661   9.27304074 -0.63912431\nApr 2019 102.3 105.5645 106.0825  -3.26453259 -0.51799031\nMay 2019 118.6 105.8104 105.8478  12.78961029 -0.03744185\nJun 2019 109.1 106.4235 105.6324   2.67648686  0.79112529\nJul 2019 120.4 104.6128 105.4636  15.78719927 -0.85075490\nAug 2019  64.6 105.6598 105.2320 -41.05983503  0.42784829\nSep 2019 110.4 105.0552 104.9091   5.34484540  0.14607297\nOct 2019 118.5 104.4491 104.5092  14.05094470 -0.06015490\nNov 2019 107.8 104.6479 104.1309   3.15211067  0.51695828\nDec 2019  87.6 102.7603 103.8287 -15.16034328 -1.06833688\n\nForecasts:\n               y_f     sa_f      t_f         s_f         i_f\nJan 2020 100.60122 103.6937 103.6240  -3.0924959  0.06974302\nFeb 2020 104.88729 104.1412 103.5059   0.7461336  0.63521163\nMar 2020 115.35780 102.9935 103.4731  12.3643224 -0.47967022\nApr 2020 100.71674 103.6347 103.4547  -2.9179581  0.17994685\nMay 2020 108.88911 103.5382 103.4107   5.3508925  0.12754385\nJun 2020 112.99300 103.2766 103.3331   9.7163730 -0.05643767\nJul 2020 119.00943 103.0564 103.2277  15.9529868 -0.17125131\nAug 2020  58.52488 103.3292 103.1321 -44.8042957  0.19705844\nSep 2020 112.54290 103.0286 103.0125   9.5143004  0.01610625\nOct 2020 113.24225 102.7349 102.8926  10.5073243 -0.15771395\nNov 2020 105.65780 102.9839 102.7820   2.6738591  0.20193998\nDec 2020  91.03785 102.4851 102.6915 -11.4472191 -0.20644338\n```\n:::\n\n```{.r .cell-code}\n# Diagnostics sur la désaisonnalisation\nmod$diagnostics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRelative contribution of the components to the stationary\nportion of the variance in the original series,\nafter the removal of the long term trend\n Trend computed by Hodrick-Prescott filter (cycle length = 8.0 years)\n           Component\n Cycle         2.275\n Seasonal     89.957\n Irregular     0.740\n TD & Hol.     2.242\n Others        3.886\n Total        99.100\n\nCombined test in the entire series\n Non parametric tests for stable seasonality\n                                                          P.value\n   Kruskall-Wallis test                                          0\n   Test for the presence of seasonality assuming stability       0\n   Evolutive seasonality test                                    0\n \n Identifiable seasonality present\n\nResidual seasonality tests\n                                      P.value\n qs test on sa                          0.085\n qs test on i                           0.012\n f-test on sa (seasonal dummies)        0.542\n f-test on i (seasonal dummies)         0.254\n Residual seasonality (entire series)   0.438\n Residual seasonality (last 3 years)    0.999\n f-test on sa (td)                      0.671\n f-test on i (td)                       0.997\n```\n:::\n\n```{.r .cell-code}\n# Pour tracer les coefficients saisonniers (hors CJO) et irrégulier\nplot(mod$decomposition)\n```\n\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-8-2.pdf)\n:::\n\n```{.r .cell-code}\n# Coefficients saisonniers + CJO : plus erratiques\nggmonthplot(ggdemetra::seasonal(mod))\n```\n\n::: {.cell-output-display}\n![](3_Decomposition_files/figure-beamer/unnamed-chunk-8-3.pdf)\n:::\n:::\n\n\n# Conclusion\n\n- La désaisonnalisation permet de faire des comparaisons temporelles et spatiales\n\n- Plusieurs schémas de décomposition possibles en fonction des relations entre les composantes :\n\n\t- Additif : $X_t = {TC}_t + S_t + I_t$ saisonnalité et irrégulier indépendant du niveau\n\t\n\t- Multiplicatif : $X_t = {TC}_t \\times S_t \\times I_t$ saisonnalité et irrégulier proportionnels au niveau\n\t\n### Bibliographie\n\n\nHyndman, R.J., & Athanasopoulos, G. (2018) *Forecasting: principles and practice*, 2nd edition, OTexts: Melbourne, Australia. OTexts.com/fpp2. Accessed on oct. 2023.\n\nLadiray D., et Quenneville B. (1999). Comprendre la méthode X11, *Institut National de la Statistique et des Études Économiques*, <https://www.census.gov/pub/ts/papers/x11doc.pdf>.\n\nGomez, V., et Maravall, A. (1997), Programs TRAMO and SEATS: Instructions for the User, *Banco de Espana*.\n\n\n",
    "supporting": [
      "3_Decomposition_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}